<!doctype html>
<html lang="vi">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>English Fun Quiz - Listen & Choose</title>
    <style>
        body {
            margin: 0;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #a8ff78, #78ffd6);
            font-family: "Segoe UI", Roboto, sans-serif;
            padding: 20px;
        }

        .wrap {
            width: 100%;
            max-width: 720px;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
        }

        /* This is now the main listen button */
        .listen-btn-big {
            font-size: 80px;
            text-align: center;
            margin-bottom: 10px;
            cursor: pointer;
            transition: transform 0.2s;
            user-select: none;
        }

        .listen-btn-big:hover {
            transform: scale(1.1);
        }

        .choices {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .choice {
            background: #f0f4ff;
            border-radius: 12px;
            padding: 14px;
            text-align: center;
            font-size: 18px;
            cursor: pointer;
            transition: 0.2s;
            border: 3px solid transparent;
            user-select: none;
        }

        .choice:hover {
            transform: scale(1.05);
        }

        .choice.correct {
            border-color: #4CAF50;
            background: #e7fbe9;
        }

        .choice.wrong {
            border-color: #f44336;
            background: #ffeaea;
        }

        .progress {
            height: 10px;
            background: #e0e4ff;
            border-radius: 999px;
            overflow: hidden;
            margin-top: 14px;
        }

        .progress>i {
            display: block;
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #11998e, #38ef7d);
        }

        .header {
            display: flex;
            justify-content: flex-end; /* Changed to move score to the right */
            align-items: center;
        }

        .btn {
            border: none;
            border-radius: 10px;
            padding: 10px 16px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .score {
            background: #f3f5fb;
            border-radius: 8px;
            padding: 6px 10px;
            font-weight: bold;
        }

        .result {
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }

        .result.show {
            display: flex;
        }

        .bigscore {
            font-size: 36px;
            font-weight: 800;
        }
    </style>
</head>

<body>
    <div class="wrap">
        <div class="card" id="game">
            <div class="header">
                <!-- The small speak button has been removed for simplicity -->
                <div class="score" id="score">Score: 0</div>
            </div>
            <!-- The emoji div is now a big "listen" button -->
            <div class="listen-btn-big" id="listenBtn">🔊</div>
            <p id="prompt">Listen and choose the correct word.</p>
            <div class="choices" id="choices"></div>
            <div class="progress"><i id="bar"></i></div>
            <div style="margin-top:10px; text-align:right;">
                <button class="btn" id="restart">Restart</button>
            </div>
            <div class="result" id="result">
                <div class="bigscore" id="finalScore">0 / 10</div>
                <div id="finalText">Well done!</div>
            </div>
        </div>
    </div>

    <script>
        const QUESTIONS = [
            // The emoji is no longer shown, but the data structure is the same
            { emoji: '🍌', word: 'banana', choices: ['banana', 'banna', 'banan', 'benana'] },
            { emoji: '🐘', word: 'elephant', choices: ['elefant', 'elephant', 'elephent', 'elaphant'] },
            { emoji: '🚀', word: 'rocket', choices: ['roket', 'rokket', 'rocket', 'rockit'] },
            { emoji: '🍓', word: 'strawberry', choices: ['strawberry', 'stawberry', 'strowbery', 'stroberry'] },
            { emoji: '🦋', word: 'butterfly', choices: ['butter-fly', 'butterfly', 'buterfly', 'butterfli'] },
            { emoji: '🌈', word: 'rainbow', choices: ['rainbow', 'rain-bow', 'ranbow', 'reinbow'] },
            { emoji: '🏠', word: 'house', choices: ['hause', 'hous', 'howse', 'house'] },
            { emoji: '🦁', word: 'lion', choices: ['lion', 'laion', 'lyon', 'lionn'] },
            { emoji: '🚴', word: 'bicycle', choices: ['bycicle', 'bicycle', 'bicecle', 'bicycal'] },
            { emoji: '🎂', word: 'cake', choices: ['kake', 'ceik', 'cake', 'caik'] }
        ];

        let order = shuffle([...Array(QUESTIONS.length).keys()]);
        let current = 0;
        let score = 0;
        let accepting = true;

        const listenBtnEl = document.getElementById('listenBtn');
        const choicesEl = document.getElementById('choices');
        const scoreEl = document.getElementById('score');
        const barEl = document.getElementById('bar');
        const resultEl = document.getElementById('result');
        const finalScoreEl = document.getElementById('finalScore');
        const finalTextEl = document.getElementById('finalText');
        const restartBtn = document.getElementById('restart');

        function shuffle(arr) { for (let i = arr.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1));[arr[i], arr[j]] = [arr[j], arr[i]]; } return arr; }

        function startGame() {
            order = shuffle(order);
            current = 0; score = 0; accepting = true;
            scoreEl.textContent = 'Score: 0';
            resultEl.classList.remove('show');
            renderQuestion();
        }

        function renderQuestion() {
            const q = QUESTIONS[order[current]];
            document.getElementById('prompt').textContent = 'Listen and choose the correct word.';
            
            // Speak the word automatically when the question loads
            speakText(q.word);

            const opts = shuffle(q.choices.slice());
            choicesEl.innerHTML = '';
            opts.forEach(opt => {
                const b = document.createElement('button');
                b.className = 'choice';
                b.textContent = opt;
                b.onclick = () => choose(b, opt, q.word);
                choicesEl.appendChild(b);
            });
            barEl.style.width = `${(current / QUESTIONS.length) * 100}%`;
        }

        function choose(btn, picked, correct) {
            if (!accepting) return;
            accepting = false;
            const isCorrect = picked === correct;
            if (isCorrect) {
                score += 10;
                btn.classList.add('correct');
                speakText('Great!'); // Simpler feedback
            } else {
                btn.classList.add('wrong');
                [...choicesEl.children].forEach(b => { if (b.textContent === correct) b.classList.add('correct'); });
                speakText('No. The correct word is ' + correct); // Clearer feedback
            }
            scoreEl.textContent = 'Score: ' + score;
            setTimeout(() => {
                current++;
                if (current >= QUESTIONS.length) showResult();
                else { accepting = true; renderQuestion(); }
            }, 1500); // Slightly longer delay to see the correct answer
        }

        function showResult() {
            barEl.style.width = '100%';
            resultEl.classList.add('show');
            finalScoreEl.textContent = `${score} / ${QUESTIONS.length * 10}`;
            const p = Math.round(score / (QUESTIONS.length * 10) * 100);
            finalTextEl.textContent = p >= 80 ? 'Excellent! 🌟' : p >= 50 ? 'Good job! 👍' : 'Try again! 💪';
            speakText(`You scored ${score} points. ${finalTextEl.textContent}`);
        }

        function speakText(text) {
            // Check if the browser supports speech synthesis
            if (!('speechSynthesis' in window)) {
                console.log("Sorry, your browser doesn't support text-to-speech.");
                return;
            }
            const ut = new SpeechSynthesisUtterance(text);
            ut.lang = 'en-US';
            ut.rate = 0.9; // Speak a little slower for clarity
            speechSynthesis.cancel(); // Stop any previous speech
            speechSynthesis.speak(ut);
        }
        
        // Allow re-listening to the word by clicking the big speaker button
        listenBtnEl.onclick = () => {
            if (current < QUESTIONS.length) {
                const q = QUESTIONS[order[current]];
                speakText(q.word);
            }
        };

        restartBtn.onclick = startGame;
        
        // Start the game when the page loads
        startGame();
    </script>
</body>

</html>